/*
 * Vermont Aggregator Subsystem
 * Copyright (C) 2009 Vermont Project
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License
 * as published by the Free Software Foundation; either version 2
 * of the License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
 *
 */

#ifdef PLUGIN_SUPPORT_ENABLED
#include "OSFingerprint.h"
#include "OSDetail.h"
#include <sstream>
#include <string>
#include <arpa/inet.h>
using namespace std;

OSFingerprint::OSFingerprint(){

}


/*
 * create string representation of a specific fingerprint
 */
string OSFingerprint::toString() const{
    ostringstream strm;
    bool test = false;
    string san_flag = "A";

    /* PCAP Timestamp */
    strm << m_Pcap_Timestamp.tv_sec << ".";
    strm << m_Pcap_Timestamp.tv_usec << ":";
    /* IP Source */
    strm << inet_ntoa(m_IP_Source) << ":";
    /* TCP Source Port */
    strm << m_TCP_SourcePort << ":";
    /* IP Dest */
    strm << inet_ntoa(m_IP_Dest) << ":";
    /* TCP Dest Port */
    strm << m_TCP_DestPort << ":";
    /* IP IHL */
    strm << m_IP_IHL * 4 << ":";
    /* IP TOS */
    strm << m_IP_TOS << ":";
    /* IP ID */
    strm << m_IP_ID << ":";
    /* IP Protocol */
    strm << m_IP_Protocol << ":";
    /* IP Don't Fragment */
    strm << m_IP_DF << ":";
    /* IP TTL */
    strm << m_IP_TTL << ":";
    /* TCP Window Size */
    strm << m_TCP_Window_Size<< ":";
    /* TCP MSS */
    strm << m_TCP_Options.mss << ":";
    /* TCP Window Scale */
    strm << (uint16_t) m_TCP_Options.window_scale << ":";
    /* TCP SACK permitted Option */
    strm << (bool) m_TCP_Options.sack_set << ":";
    /* TCP NOP Option */
    strm << m_TCP_Options.nop_set << ":";
    /* TCP Timestamp set */
    strm << (bool) m_TCP_Options.timestamp_set << ":";
    /* TCP Timestamp */
    strm << m_TCP_Options.tstamp << ":";
    /* TCP Timestamp Secr */
    strm << m_TCP_Options.tsecr << ":";
    /* TCP Urgent Flag */
    strm << m_TCP_URG << ":";
    /* TCP Push Flag */
    strm << m_TCP_PSH << ":";
    /* TCP Reset Flag */
    strm << m_TCP_RST << ":";
    /* TCP FIN Flag */
    strm << m_TCP_FIN << ":";
    /* TCP Urgent Pointer */
    strm << m_TCP_URG_PTR << ":";
    /* TCP EOL Option set */
    strm << (bool) m_TCP_Options.eol_set << ":";
    /* TCP Data Offset */
    strm << m_TCP_DOFF << ":";
    /* TCP Sequence Number */
    strm << m_TCP_SEQ << ":";
    /* TCP Acknowlegment Number */
    strm << m_TCP_ACK_SEQ << ":";
    /* TCP Reserved 1 */
    strm << m_TCP_RES1 << ":";
    /* TCP Reserved 2 */
    strm << m_TCP_RES2 << ":";

    if(m_TCP_SYN == true && m_TCP_ACK == true){
        test = true;
        san_flag = "SA";
    }
    if(m_TCP_SYN == true && m_TCP_ACK == false){
        test = true;
        san_flag = "S";
    }
    if(test == false){
        san_flag = "A";
    }
    strm << san_flag << ":";

    /*TCP Packet Length*/
    strm << m_Data_Length << ":";
    /* Options Corrupt */
    strm << (bool) m_TCP_Options.options_corrupt << ":";
    if ( m_TCP_Options.has_options ){
        strm << ordered_options;
    } else {
        strm << "?";
    }
    strm << endl;

    return strm.str();
}

uint16_t OSFingerprint::guessInitialTTL(uint8_t ttl){
        if (ttl <= 32)
            return 32;
        else if (ttl <= 64)
            return 64;
        else if (ttl <= 128)
            return 128;
        else
            return 255;
}

/*
 * try to detect the Operating System using Weka decision trees
 */
void OSFingerprint::detectOS(){
    /****Generated by WekaConverter by Ferdinand Mayet****/
    if (m_TCP_Window_Size  <= 31098){
       if (m_TCP_SourcePort  <= 32771){
          if (m_TCP_SourcePort  <= 80){
             if (m_TCP_Window_Size  <= 1285){ m_OS_Type = "Linux"; }
             if (m_TCP_Window_Size  > 1285){
                if (m_TCP_Window_Size  <= 1841){ m_OS_Type = "unknown"; }
                if (m_TCP_Window_Size  > 1841){
                   if (m_TCP_Options.window_scale  <= 2){
                      if (m_TCP_Options.window_scale  <= 1){ m_OS_Type = "Linux"; }
                      if (m_TCP_Options.window_scale  > 1){ m_OS_Type = "unknown"; }
                      }
                   if (m_TCP_Options.window_scale  > 2){ m_OS_Type = "Linux"; }
                   }
                }
             }
          if (m_TCP_SourcePort  > 80){
             if (m_TCP_Window_Size  <= 24656){ m_OS_Type = "Linux"; }
             if (m_TCP_Window_Size  > 24656){
                if (m_TCP_SourcePort  <= 3751){ m_OS_Type = "Linux"; }
                if (m_TCP_SourcePort  > 3751){
                   if (m_TCP_SourcePort  <= 6060){ m_OS_Type = "Mac"; }
                   if (m_TCP_SourcePort  > 6060){ m_OS_Type = "Linux"; }
                   }
                }
             }
          }
       if (m_TCP_SourcePort  > 32771){
          if (m_TCP_RST  <= 0){ m_OS_Type = "Linux"; }
          if (m_TCP_RST  > 0){
             if (m_TCP_SourcePort  <= 49369){ m_OS_Type = "Linux"; }
             if (m_TCP_SourcePort  > 49369){
                if (m_TCP_SourcePort  <= 52679){
                   if (m_TCP_SourcePort  <= 51009){
                      if (m_TCP_SourcePort  <= 50576){
                         if (m_TCP_SourcePort  <= 49984){
                            if (m_TCP_SourcePort  <= 49815){ m_OS_Type = "Mac"; }
                            if (m_TCP_SourcePort  > 49815){
                               if (m_TCP_SourcePort  <= 49847){ m_OS_Type = "Linux"; }
                               if (m_TCP_SourcePort  > 49847){ m_OS_Type = "Mac"; }
                               }
                            }
                         if (m_TCP_SourcePort  > 49984){ m_OS_Type = "Mac"; }
                         }
                      if (m_TCP_SourcePort  > 50576){
                         if (m_TCP_SourcePort  <= 50794){ m_OS_Type = "Linux"; }
                         if (m_TCP_SourcePort  > 50794){
                            if (m_TCP_SourcePort  <= 50893){ m_OS_Type = "Mac"; }
                            if (m_TCP_SourcePort  > 50893){ m_OS_Type = "Linux"; }
                            }
                         }
                      }
                   if (m_TCP_SourcePort  > 51009){ m_OS_Type = "Mac"; }
                   }
                if (m_TCP_SourcePort  > 52679){
                   if (m_TCP_SourcePort  <= 52891){ m_OS_Type = "Linux"; }
                   if (m_TCP_SourcePort  > 52891){
                      if (m_TCP_SourcePort  <= 54544){
                         if (m_TCP_Window_Size  <= 72){ m_OS_Type = "Mac"; }
                         if (m_TCP_Window_Size  > 72){ m_OS_Type = "Linux"; }
                         }
                      if (m_TCP_SourcePort  > 54544){
                         if (m_TCP_SourcePort  <= 56856){ m_OS_Type = "Linux"; }
                         if (m_TCP_SourcePort  > 56856){
                            if (m_TCP_SourcePort  <= 59746){
                               if (m_TCP_SourcePort  <= 57082){ m_OS_Type = "Mac"; }
                               if (m_TCP_SourcePort  > 57082){ m_OS_Type = "Linux"; }
                               }
                            if (m_TCP_SourcePort  > 59746){
                               if (m_TCP_SourcePort  <= 59986){ m_OS_Type = "Mac"; }
                               if (m_TCP_SourcePort  > 59986){
                                  if (m_TCP_SourcePort  <= 60262){ m_OS_Type = "Linux"; }
                                  if (m_TCP_SourcePort  > 60262){
                                     if (m_TCP_SourcePort  <= 60637){ m_OS_Type = "Mac"; }
                                     if (m_TCP_SourcePort  > 60637){
                                        if (m_TCP_SourcePort  <= 60872){ m_OS_Type = "Linux"; }
                                        if (m_TCP_SourcePort  > 60872){ m_OS_Type = "Mac"; }
                                        }
                                     }
                                  }
                               }
                            }
                         }
                      }
                   }
                }
             }
          }
       }
    if (m_TCP_Window_Size  > 31098){
       if (m_IP_TTL  <= 64){
          if (m_TCP_SourcePort  <= 2392){ m_OS_Type = "Linux"; }
          if (m_TCP_SourcePort  > 2392){
             if (m_TCP_DOFF  <= 1536){
                if (m_TCP_Window_Size  <= 33237){ m_OS_Type = "Mac"; }
                if (m_TCP_Window_Size  > 33237){
                   if (m_TCP_Window_Size  <= 64647){
                      if (m_TCP_Window_Size  <= 33323){ m_OS_Type = "Mac"; }
                      if (m_TCP_Window_Size  > 33323){ m_OS_Type = "Linux"; }
                      }
                   if (m_TCP_Window_Size  > 64647){ m_OS_Type = "Mac"; }
                   }
                }
             if (m_TCP_DOFF  > 1536){ m_OS_Type = "Mac"; }
             }
          }
       if (m_IP_TTL  > 64){ m_OS_Type = "Linux"; }
       }

    /****End of generated Code****/

    /****Generated by WekaConverter by Ferdinand Mayet****/
    if (m_OS_Type == "Linux"){
       if (m_TCP_Window_Size  <= 75){
          if (m_TCP_Window_Size  <= 46){
             if (m_TCP_PSH  <= 0){
                if (m_TCP_Window_Size  <= 43){
                   if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                   if (m_TCP_Options.mss  > 1460){
                      if (m_TCP_Window_Size  <= 0){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                      if (m_TCP_Window_Size  > 0){
                         if (m_TCP_Window_Size  <= 8){m_OS_Version = "Linux Linux 2.4.X"; }
                         if (m_TCP_Window_Size  > 8){
                            if (m_TCP_Window_Size  <= 23){
                               if (m_TCP_Window_Size  <= 12){m_OS_Version = "Linux 2.6.17 - 2.6.35"; }
                               if (m_TCP_Window_Size  > 12){m_OS_Version = "Linux Linux 2.6.X"; }
                               }
                            if (m_TCP_Window_Size  > 23){
                               if (m_IP_TOS  <= 8){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                               if (m_IP_TOS  > 8){m_OS_Version = "Linux 2.6.17 - 2.6.35"; }
                               }
                            }
                         }
                      }
                   }
                if (m_TCP_Window_Size  > 43){
                   if (m_TCP_Options.mss  <= 1460){
                      if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                      if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.32"; }
                      }
                   if (m_TCP_Options.mss  > 1460){
                      if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.32"; }
                      if (m_TCP_FIN  > 0){m_OS_Version = "Linux Linux 2.6.X"; }
                      }
                   }
                }
             if (m_TCP_PSH  > 0){
                if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                if (m_TCP_Options.mss  > 1460){
                   if (m_TCP_Window_Size  <= 33){
                      if (m_IP_TOS  <= 8){
                         if (m_TCP_Window_Size  <= 12){m_OS_Version = "Linux 2.6.17 - 2.6.35"; }
                         if (m_TCP_Window_Size  > 12){m_OS_Version = "Linux Linux 2.6.X"; }
                         }
                      if (m_IP_TOS  > 8){m_OS_Version = "Linux 2.6.17 - 2.6.35"; }
                      }
                   if (m_TCP_Window_Size  > 33){
                      if (m_IP_TOS  <= 0){m_OS_Version = "Linux Linux 2.6.X"; }
                      if (m_IP_TOS  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                      }
                   }
                }
             }
          if (m_TCP_Window_Size  > 46){
             if (m_TCP_PSH  <= 0){
                if (m_TCP_Window_Size  <= 63){
                   if (m_TCP_Window_Size  <= 54){m_OS_Version = "Linux Linux 2.6.X"; }
                   if (m_TCP_Window_Size  > 54){
                      if (m_TCP_Window_Size  <= 60){m_OS_Version = "Linux 2.6.32"; }
                      if (m_TCP_Window_Size  > 60){m_OS_Version = "Linux Linux 2.6.X"; }
                      }
                   }
                if (m_TCP_Window_Size  > 63){m_OS_Version = "Linux Linux 2.6.X"; }
                }
             if (m_TCP_PSH  > 0){
                if (m_TCP_Window_Size  <= 55){
                   if (m_TCP_FIN  <= 0){m_OS_Version = "Linux Linux 2.6.X"; }
                   if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                   }
                if (m_TCP_Window_Size  > 55){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                }
             }
          }
       if (m_TCP_Window_Size  > 75){
          if (m_TCP_ACK == true && m_TCP_SYN == false){
             if (m_TCP_Window_Size  <= 6150){
                if (m_TCP_Window_Size  <= 113){
                   if (m_TCP_PSH  <= 0){
                      if (m_TCP_Window_Size  <= 88){
                         if (m_TCP_FIN  <= 0){
                            if (m_TCP_Window_Size  <= 79){m_OS_Version = "Linux Linux 2.6.X"; }
                            if (m_TCP_Window_Size  > 79){
                               if (m_TCP_Window_Size  <= 84){
                                  if (m_TCP_Options.nop_set  <= 3){
                                     if (m_TCP_Window_Size  <= 81){
                                        if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                        if (m_TCP_Options.mss  > 1460){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                        }
                                     if (m_TCP_Window_Size  > 81){m_OS_Version = "Linux 2.6.32"; }
                                     }
                                  if (m_TCP_Options.nop_set  > 3){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  }
                               if (m_TCP_Window_Size  > 84){
                                  if (m_TCP_Options.timestamp_set  <= 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  if (m_TCP_Options.timestamp_set  > 0){m_OS_Version = "Linux Linux 2.6.X"; }
                                  }
                               }
                            }
                         if (m_TCP_FIN  > 0){
                            if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux Linux 2.6.X"; }
                            if (m_TCP_Options.mss  > 1460){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                            }
                         }
                      if (m_TCP_Window_Size  > 88){
                         if (m_TCP_Window_Size  <= 92){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                         if (m_TCP_Window_Size  > 92){
                            if (m_TCP_Window_Size  <= 106){
                               if (m_TCP_Options.mss  <= 1452){
                                  if (m_TCP_Window_Size  <= 97){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  if (m_TCP_Window_Size  > 97){
                                     if (m_TCP_Window_Size  <= 104){m_OS_Version = "Linux Linux 2.6.X"; }
                                     if (m_TCP_Window_Size  > 104){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                     }
                                  }
                               if (m_TCP_Options.mss  > 1452){
                                  if (m_TCP_FIN  <= 0){m_OS_Version = "Linux Linux 2.6.X"; }
                                  if (m_TCP_FIN  > 0){
                                     if (m_TCP_Window_Size  <= 97){m_OS_Version = "Linux Linux 2.6.X"; }
                                     if (m_TCP_Window_Size  > 97){
                                        if (m_TCP_Window_Size  <= 104){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                        if (m_TCP_Window_Size  > 104){m_OS_Version = "Linux Linux 2.6.X"; }
                                        }
                                     }
                                  }
                               }
                            if (m_TCP_Window_Size  > 106){
                               if (m_TCP_Window_Size  <= 110){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                               if (m_TCP_Window_Size  > 110){m_OS_Version = "Linux Linux 2.6.X"; }
                               }
                            }
                         }
                      }
                   if (m_TCP_PSH  > 0){
                      if (m_TCP_Window_Size  <= 90){
                         if (m_TCP_Window_Size  <= 79){
                            if (m_IP_TOS  <= 8){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                            if (m_IP_TOS  > 8){m_OS_Version = "Linux Linux 2.6.X"; }
                            }
                         if (m_TCP_Window_Size  > 79){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                         }
                      if (m_TCP_Window_Size  > 90){
                         if (m_TCP_Window_Size  <= 91){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                         if (m_TCP_Window_Size  > 91){
                            if (m_TCP_Window_Size  <= 107){
                               if (m_TCP_Window_Size  <= 93){
                                  if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                  if (m_TCP_Options.mss  > 1460){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  }
                               if (m_TCP_Window_Size  > 93){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                               }
                            if (m_TCP_Window_Size  > 107){
                               if (m_TCP_Window_Size  <= 110){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                               if (m_TCP_Window_Size  > 110){
                                  if (m_TCP_Window_Size  <= 112){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  if (m_TCP_Window_Size  > 112){
                                     if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                     if (m_TCP_Options.mss  > 1460){
                                        if (m_TCP_FIN  <= 0){m_OS_Version = "Linux Linux 2.6.X"; }
                                        if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                        }
                                     }
                                  }
                               }
                            }
                         }
                      }
                   }
                if (m_TCP_Window_Size  > 113){
                   if (m_TCP_Window_Size  <= 115){m_OS_Version = "Linux 2.6.32"; }
                   if (m_TCP_Window_Size  > 115){
                      if (m_TCP_Window_Size  <= 123){
                         if (m_TCP_Window_Size  <= 122){
                            if (m_IP_TOS  <= 8){
                               if (m_TCP_Window_Size  <= 121){
                                  if (m_TCP_PSH  <= 0){
                                     if (m_TCP_FIN  <= 0){
                                        if (m_TCP_Window_Size  <= 118){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                        if (m_TCP_Window_Size  > 118){
                                           if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                           if (m_TCP_Options.mss  > 1460){m_OS_Version = "Linux Linux 2.6.X"; }
                                           }
                                        }
                                     if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                     }
                                  if (m_TCP_PSH  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  }
                               if (m_TCP_Window_Size  > 121){m_OS_Version = "Linux Linux 2.4.X"; }
                               }
                            if (m_IP_TOS  > 8){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                            }
                         if (m_TCP_Window_Size  > 122){
                            if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux Linux 2.4.X"; }
                            if (m_TCP_Options.mss  > 1460){
                               if (m_TCP_PSH  <= 0){
                                  if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.32"; }
                                  if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                  }
                               if (m_TCP_PSH  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                               }
                            }
                         }
                      if (m_TCP_Window_Size  > 123){
                         if (m_IP_TOS  <= 8){
                            if (m_IP_TOS  <= 0){
                               if (m_TCP_Window_Size  <= 1034){
                                  if (m_TCP_PSH  <= 0){
                                     if (m_TCP_Window_Size  <= 185){
                                        if (m_TCP_Window_Size  <= 182){
                                           if (m_TCP_Window_Size  <= 136){
                                              if (m_TCP_Window_Size  <= 135){
                                                 if (m_TCP_Window_Size  <= 129){
                                                    if (m_TCP_Window_Size  <= 128){
                                                       if (m_TCP_Window_Size  <= 124){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       if (m_TCP_Window_Size  > 124){
                                                          if (m_TCP_Window_Size  <= 125){m_OS_Version = "Linux 2.6.32"; }
                                                          if (m_TCP_Window_Size  > 125){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          }
                                                       }
                                                    if (m_TCP_Window_Size  > 128){m_OS_Version = "Linux Linux 2.6.X"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 129){
                                                    if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    if (m_TCP_Options.mss  > 1460){
                                                       if (m_TCP_Window_Size  <= 131){m_OS_Version = "Linux 2.6.32"; }
                                                       if (m_TCP_Window_Size  > 131){
                                                          if (m_TCP_Window_Size  <= 133){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          if (m_TCP_Window_Size  > 133){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       }
                                                    }
                                                 }
                                              if (m_TCP_Window_Size  > 135){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                              }
                                           if (m_TCP_Window_Size  > 136){
                                              if (m_TCP_Window_Size  <= 137){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Window_Size  > 137){
                                                 if (m_TCP_Window_Size  <= 155){
                                                    if (m_TCP_Window_Size  <= 154){
                                                       if (m_TCP_Window_Size  <= 147){
                                                          if (m_TCP_Window_Size  <= 145){
                                                             if (m_TCP_Window_Size  <= 139){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             if (m_TCP_Window_Size  > 139){
                                                                if (m_TCP_Window_Size  <= 141){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_Window_Size  > 141){m_OS_Version = "Linux 2.6.32"; }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 145){m_OS_Version = "Linux Linux 2.6.X"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 147){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 154){m_OS_Version = "Linux Linux 2.6.X"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 155){
                                                    if (m_TCP_Window_Size  <= 157){m_OS_Version = "Linux 2.6.32"; }
                                                    if (m_TCP_Window_Size  > 157){
                                                       if (m_TCP_Window_Size  <= 159){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       if (m_TCP_Window_Size  > 159){
                                                          if (m_TCP_Window_Size  <= 165){
                                                             if (m_TCP_Window_Size  <= 163){
                                                                if (m_TCP_Window_Size  <= 160){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 160){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 163){m_OS_Version = "Linux 2.6.32"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 165){
                                                             if (m_TCP_Window_Size  <= 170){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             if (m_TCP_Window_Size  > 170){
                                                                if (m_TCP_Window_Size  <= 172){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 172){
                                                                   if (m_TCP_Window_Size  <= 179){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 179){
                                                                      if (m_TCP_Window_Size  <= 180){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 180){m_OS_Version = "Linux 2.6.32"; }
                                                                      }
                                                                   }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 182){
                                           if (m_TCP_FIN  <= 0){
                                              if (m_TCP_Options.timestamp_set  <= 0){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Options.timestamp_set  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                              }
                                           if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                           }
                                        }
                                     if (m_TCP_Window_Size  > 185){
                                        if (m_TCP_Window_Size  <= 501){
                                           if (m_TCP_Options.nop_set  <= 1){
                                              if (m_TCP_Window_Size  <= 441){
                                                 if (m_TCP_FIN  <= 0){
                                                    if (m_TCP_Window_Size  <= 369){
                                                       if (m_TCP_Window_Size  <= 232){
                                                          if (m_TCP_Window_Size  <= 215){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                          if (m_TCP_Window_Size  > 215){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 232){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 369){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                    }
                                                 if (m_TCP_FIN  > 0){
                                                    if (m_TCP_Window_Size  <= 245){m_OS_Version = "Linux Linux 2.6.X"; }
                                                    if (m_TCP_Window_Size  > 245){
                                                       if (m_TCP_Window_Size  <= 286){m_OS_Version = "Linux 2.6.32"; }
                                                       if (m_TCP_Window_Size  > 286){m_OS_Version = "Linux Linux 2.6.X"; }
                                                       }
                                                    }
                                                 }
                                              if (m_TCP_Window_Size  > 441){
                                                 if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                 if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.32"; }
                                                 }
                                              }
                                           if (m_TCP_Options.nop_set  > 1){
                                              if (m_TCP_Window_Size  <= 357){
                                                 if (m_TCP_Window_Size  <= 216){
                                                    if (m_TCP_Window_Size  <= 214){
                                                       if (m_TCP_Window_Size  <= 213){
                                                          if (m_TCP_FIN  <= 0){
                                                             if (m_TCP_Window_Size  <= 204){
                                                                if (m_TCP_Window_Size  <= 197){
                                                                   if (m_TCP_Window_Size  <= 190){
                                                                      if (m_TCP_Window_Size  <= 188){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 188){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 190){
                                                                      if (m_TCP_Window_Size  <= 192){m_OS_Version = "Linux 2.6.32"; }
                                                                      if (m_TCP_Window_Size  > 192){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      }
                                                                   }
                                                                if (m_TCP_Window_Size  > 197){m_OS_Version = "Linux 2.6.32"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 204){
                                                                if (m_TCP_Window_Size  <= 205){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 205){
                                                                   if (m_TCP_Window_Size  <= 207){
                                                                      if (m_TCP_Window_Size  <= 206){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      if (m_TCP_Window_Size  > 206){m_OS_Version = "Linux 2.6.32"; }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 207){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                }
                                                             }
                                                          if (m_TCP_FIN  > 0){
                                                             if (m_TCP_Window_Size  <= 197){
                                                                if (m_TCP_Window_Size  <= 188){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 188){
                                                                   if (m_TCP_Window_Size  <= 192){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 192){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 197){
                                                                if (m_TCP_Window_Size  <= 203){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_Window_Size  > 203){m_OS_Version = "Linux 2.6.32"; }
                                                                }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 213){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 214){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 216){
                                                    if (m_TCP_Window_Size  <= 228){
                                                       if (m_TCP_Window_Size  <= 227){
                                                          if (m_TCP_Window_Size  <= 220){
                                                             if (m_TCP_Window_Size  <= 218){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 218){
                                                                if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 220){
                                                             if (m_TCP_Window_Size  <= 224){
                                                                if (m_TCP_Window_Size  <= 221){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_Window_Size  > 221){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 224){
                                                                if (m_TCP_Window_Size  <= 225){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_Window_Size  > 225){
                                                                   if (m_TCP_Window_Size  <= 226){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 226){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                   }
                                                                }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 227){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 228){
                                                       if (m_TCP_Window_Size  <= 229){m_OS_Version = "Linux Linux 2.6.X"; }
                                                       if (m_TCP_Window_Size  > 229){
                                                          if (m_TCP_Window_Size  <= 243){
                                                             if (m_TCP_Window_Size  <= 239){
                                                                if (m_TCP_Window_Size  <= 237){
                                                                   if (m_TCP_Window_Size  <= 230){
                                                                      if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.32"; }
                                                                      if (m_TCP_FIN  > 0){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 230){
                                                                      if (m_TCP_Window_Size  <= 236){
                                                                         if (m_TCP_Window_Size  <= 232){m_OS_Version = "Linux 2.6.32"; }
                                                                         if (m_TCP_Window_Size  > 232){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 236){m_OS_Version = "Linux 2.6.32"; }
                                                                      }
                                                                   }
                                                                if (m_TCP_Window_Size  > 237){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 239){m_OS_Version = "Linux 2.6.32"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 243){
                                                             if (m_TCP_Window_Size  <= 252){
                                                                if (m_TCP_Window_Size  <= 250){
                                                                   if (m_TCP_Window_Size  <= 249){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   if (m_TCP_Window_Size  > 249){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 250){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 252){
                                                                if (m_TCP_Window_Size  <= 253){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 253){
                                                                   if (m_TCP_Window_Size  <= 277){
                                                                      if (m_TCP_Window_Size  <= 272){
                                                                         if (m_TCP_Window_Size  <= 258){
                                                                            if (m_TCP_Window_Size  <= 256){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                            if (m_TCP_Window_Size  > 256){m_OS_Version = "Linux 2.6.32"; }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 258){
                                                                            if (m_TCP_Window_Size  <= 261){
                                                                               if (m_TCP_Window_Size  <= 259){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                               if (m_TCP_Window_Size  > 259){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                               }
                                                                            if (m_TCP_Window_Size  > 261){
                                                                               if (m_TCP_Window_Size  <= 263){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                               if (m_TCP_Window_Size  > 263){
                                                                                  if (m_TCP_Window_Size  <= 271){
                                                                                     if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.32"; }
                                                                                     if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                                     }
                                                                                  if (m_TCP_Window_Size  > 271){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                  }
                                                                               }
                                                                            }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 272){
                                                                         if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.32"; }
                                                                         if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 277){
                                                                      if (m_TCP_Window_Size  <= 283){
                                                                         if (m_TCP_Window_Size  <= 280){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         if (m_TCP_Window_Size  > 280){
                                                                            if (m_TCP_Window_Size  <= 282){m_OS_Version = "Linux 2.6.32"; }
                                                                            if (m_TCP_Window_Size  > 282){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 283){
                                                                         if (m_TCP_Window_Size  <= 296){
                                                                            if (m_TCP_Window_Size  <= 289){
                                                                               if (m_TCP_Window_Size  <= 286){m_OS_Version = "Linux 2.6.32"; }
                                                                               if (m_TCP_Window_Size  > 286){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                               }
                                                                            if (m_TCP_Window_Size  > 289){m_OS_Version = "Linux 2.6.32"; }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 296){
                                                                            if (m_TCP_Window_Size  <= 314){
                                                                               if (m_TCP_Window_Size  <= 311){
                                                                                  if (m_TCP_Window_Size  <= 297){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                  if (m_TCP_Window_Size  > 297){
                                                                                     if (m_TCP_Window_Size  <= 303){
                                                                                        if (m_TCP_Window_Size  <= 299){m_OS_Version = "Linux 2.6.32"; }
                                                                                        if (m_TCP_Window_Size  > 299){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                                        }
                                                                                     if (m_TCP_Window_Size  > 303){
                                                                                        if (m_TCP_Window_Size  <= 306){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                        if (m_TCP_Window_Size  > 306){
                                                                                           if (m_TCP_Window_Size  <= 310){m_OS_Version = "Linux 2.6.32"; }
                                                                                           if (m_TCP_Window_Size  > 310){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                                           }
                                                                                        }
                                                                                     }
                                                                                  }
                                                                               if (m_TCP_Window_Size  > 311){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                               }
                                                                            if (m_TCP_Window_Size  > 314){
                                                                               if (m_TCP_Window_Size  <= 321){
                                                                                  if (m_TCP_Window_Size  <= 318){
                                                                                     if (m_TCP_Window_Size  <= 317){
                                                                                        if (m_TCP_Window_Size  <= 316){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                                        if (m_TCP_Window_Size  > 316){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                                        }
                                                                                     if (m_TCP_Window_Size  > 317){m_OS_Version = "Linux 2.6.32"; }
                                                                                     }
                                                                                  if (m_TCP_Window_Size  > 318){
                                                                                     if (m_TCP_Window_Size  <= 319){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                                     if (m_TCP_Window_Size  > 319){m_OS_Version = "Linux 2.6.32"; }
                                                                                     }
                                                                                  }
                                                                               if (m_TCP_Window_Size  > 321){
                                                                                  if (m_TCP_Window_Size  <= 340){
                                                                                     if (m_TCP_Window_Size  <= 339){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                     if (m_TCP_Window_Size  > 339){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                                     }
                                                                                  if (m_TCP_Window_Size  > 340){
                                                                                     if (m_TCP_Window_Size  <= 343){
                                                                                        if (m_TCP_Window_Size  <= 342){
                                                                                           if (m_TCP_Window_Size  <= 341){m_OS_Version = "Linux 2.6.32"; }
                                                                                           if (m_TCP_Window_Size  > 341){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                                           }
                                                                                        if (m_TCP_Window_Size  > 342){m_OS_Version = "Linux 2.6.32"; }
                                                                                        }
                                                                                     if (m_TCP_Window_Size  > 343){
                                                                                        if (m_TCP_FIN  <= 0){
                                                                                           if (m_TCP_Window_Size  <= 347){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                           if (m_TCP_Window_Size  > 347){
                                                                                              if (m_TCP_Window_Size  <= 349){m_OS_Version = "Linux 2.6.32"; }
                                                                                              if (m_TCP_Window_Size  > 349){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                              }
                                                                                           }
                                                                                        if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                                        }
                                                                                     }
                                                                                  }
                                                                               }
                                                                            }
                                                                         }
                                                                      }
                                                                   }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 }
                                              if (m_TCP_Window_Size  > 357){
                                                 if (m_TCP_Window_Size  <= 429){
                                                    if (m_TCP_Window_Size  <= 363){
                                                       if (m_TCP_Window_Size  <= 362){
                                                          if (m_TCP_Window_Size  <= 358){m_OS_Version = "Linux 2.6.32"; }
                                                          if (m_TCP_Window_Size  > 358){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 362){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 363){
                                                       if (m_TCP_Window_Size  <= 377){
                                                          if (m_TCP_Window_Size  <= 375){
                                                             if (m_TCP_Window_Size  <= 372){
                                                                if (m_TCP_Window_Size  <= 364){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 364){
                                                                   if (m_TCP_Window_Size  <= 369){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 369){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 372){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 375){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 377){
                                                          if (m_TCP_Window_Size  <= 414){
                                                             if (m_TCP_Window_Size  <= 403){
                                                                if (m_TCP_Window_Size  <= 390){
                                                                   if (m_TCP_Window_Size  <= 380){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                   if (m_TCP_Window_Size  > 380){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 390){
                                                                   if (m_TCP_Window_Size  <= 394){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 394){
                                                                      if (m_TCP_Window_Size  <= 399){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 399){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 403){
                                                                if (m_TCP_Window_Size  <= 411){
                                                                   if (m_TCP_Window_Size  <= 407){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   if (m_TCP_Window_Size  > 407){m_OS_Version = "Linux 2.6.32"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 411){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 414){
                                                             if (m_TCP_Window_Size  <= 419){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 419){
                                                                if (m_TCP_Window_Size  <= 423){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 423){
                                                                   if (m_TCP_Window_Size  <= 425){
                                                                      if (m_TCP_FIN  <= 0){m_OS_Version = "Linux 2.6.32"; }
                                                                      if (m_TCP_FIN  > 0){
                                                                         if (m_TCP_Window_Size  <= 424){m_OS_Version = "Linux 2.6.32"; }
                                                                         if (m_TCP_Window_Size  > 424){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 425){
                                                                      if (m_TCP_Window_Size  <= 426){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 426){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                      }
                                                                   }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 if (m_TCP_Window_Size  > 429){
                                                    if (m_TCP_FIN  <= 0){
                                                       if (m_TCP_Window_Size  <= 492){
                                                          if (m_TCP_Window_Size  <= 455){
                                                             if (m_TCP_Window_Size  <= 446){
                                                                if (m_TCP_Window_Size  <= 439){
                                                                   if (m_TCP_Window_Size  <= 431){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   if (m_TCP_Window_Size  > 431){
                                                                      if (m_TCP_Window_Size  <= 434){
                                                                         if (m_TCP_Window_Size  <= 433){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         if (m_TCP_Window_Size  > 433){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 434){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      }
                                                                   }
                                                                if (m_TCP_Window_Size  > 439){
                                                                   if (m_TCP_Window_Size  <= 443){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 443){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 446){
                                                                if (m_TCP_Window_Size  <= 447){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 447){
                                                                   if (m_TCP_Window_Size  <= 453){
                                                                      if (m_TCP_Window_Size  <= 448){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 448){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 453){m_OS_Version = "Linux 2.6.32"; }
                                                                   }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 455){
                                                             if (m_TCP_Window_Size  <= 459){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             if (m_TCP_Window_Size  > 459){
                                                                if (m_TCP_Window_Size  <= 461){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_Window_Size  > 461){
                                                                   if (m_TCP_Window_Size  <= 477){
                                                                      if (m_TCP_Window_Size  <= 473){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 473){m_OS_Version = "Linux 2.6.32"; }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 477){
                                                                      if (m_TCP_Window_Size  <= 490){
                                                                         if (m_TCP_Window_Size  <= 478){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         if (m_TCP_Window_Size  > 478){
                                                                            if (m_TCP_Window_Size  <= 485){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                            if (m_TCP_Window_Size  > 485){
                                                                               if (m_TCP_Window_Size  <= 489){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                               if (m_TCP_Window_Size  > 489){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                               }
                                                                            }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 490){
                                                                         if (m_TCP_Window_Size  <= 491){m_OS_Version = "Linux 2.6.32"; }
                                                                         if (m_TCP_Window_Size  > 491){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         }
                                                                      }
                                                                   }
                                                                }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 492){
                                                          if (m_TCP_Window_Size  <= 496){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          if (m_TCP_Window_Size  > 496){
                                                             if (m_TCP_Window_Size  <= 499){
                                                                if (m_TCP_Window_Size  <= 497){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 497){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 499){
                                                                if (m_TCP_Window_Size  <= 500){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 500){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    if (m_TCP_FIN  > 0){
                                                       if (m_TCP_Window_Size  <= 492){
                                                          if (m_TCP_Window_Size  <= 444){m_OS_Version = "Linux 2.6.32"; }
                                                          if (m_TCP_Window_Size  > 444){
                                                             if (m_TCP_Window_Size  <= 452){
                                                                if (m_TCP_Window_Size  <= 447){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_Window_Size  > 447){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 452){m_OS_Version = "Linux 2.6.32"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 492){m_OS_Version = "Linux Linux 2.6.X"; }
                                                       }
                                                    }
                                                 }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 501){
                                           if (m_TCP_Window_Size  <= 985){
                                              if (m_TCP_FIN  <= 0){
                                                 if (m_TCP_Window_Size  <= 733){
                                                    if (m_TCP_Window_Size  <= 728){
                                                       if (m_TCP_Window_Size  <= 677){
                                                          if (m_TCP_Window_Size  <= 632){
                                                             if (m_TCP_Window_Size  <= 614){
                                                                if (m_TCP_Window_Size  <= 558){
                                                                   if (m_TCP_Window_Size  <= 552){
                                                                      if (m_TCP_Window_Size  <= 517){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      if (m_TCP_Window_Size  > 517){
                                                                         if (m_TCP_Window_Size  <= 524){m_OS_Version = "Linux 2.6.32"; }
                                                                         if (m_TCP_Window_Size  > 524){
                                                                            if (m_TCP_Window_Size  <= 529){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            if (m_TCP_Window_Size  > 529){m_OS_Version = "Linux 2.6.32"; }
                                                                            }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 552){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 558){m_OS_Version = "Linux 2.6.32"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 614){
                                                                if (m_TCP_Window_Size  <= 628){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 628){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 632){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 677){
                                                          if (m_TCP_Window_Size  <= 693){
                                                             if (m_TCP_Window_Size  <= 684){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             if (m_TCP_Window_Size  > 684){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 693){
                                                             if (m_TCP_Window_Size  <= 717){
                                                                if (m_TCP_Window_Size  <= 715){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 715){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 717){
                                                                if (m_TCP_RST  <= 0){
                                                                   if (m_TCP_Window_Size  <= 727){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 727){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                if (m_TCP_RST  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    if (m_TCP_Window_Size  > 728){m_OS_Version = "Linux Linux 2.6.X"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 733){
                                                    if (m_TCP_Window_Size  <= 829){m_OS_Version = "Linux 2.6.32"; }
                                                    if (m_TCP_Window_Size  > 829){
                                                       if (m_TCP_Window_Size  <= 858){
                                                          if (m_TCP_Window_Size  <= 850){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                          if (m_TCP_Window_Size  > 850){m_OS_Version = "Linux Linux 2.6.X"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 858){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    }
                                                 }
                                              if (m_TCP_FIN  > 0){
                                                 if (m_TCP_Window_Size  <= 711){
                                                    if (m_TCP_Window_Size  <= 697){
                                                       if (m_TCP_Window_Size  <= 615){m_OS_Version = "Linux 2.6.32"; }
                                                       if (m_TCP_Window_Size  > 615){
                                                          if (m_TCP_Window_Size  <= 640){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                          if (m_TCP_Window_Size  > 640){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       }
                                                    if (m_TCP_Window_Size  > 697){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 711){
                                                    if (m_TCP_Window_Size  <= 756){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    if (m_TCP_Window_Size  > 756){
                                                       if (m_TCP_Window_Size  <= 863){
                                                          if (m_TCP_Window_Size  <= 806){m_OS_Version = "Linux 2.6.32"; }
                                                          if (m_TCP_Window_Size  > 806){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 863){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    }
                                                 }
                                              }
                                           if (m_TCP_Window_Size  > 985){
                                              if (m_TCP_Window_Size  <= 1002){m_OS_Version = "Linux Linux 2.6.X"; }
                                              if (m_TCP_Window_Size  > 1002){
                                                 if (m_TCP_Window_Size  <= 1018){m_OS_Version = "Linux 2.6.32"; }
                                                 if (m_TCP_Window_Size  > 1018){
                                                    if (m_TCP_Window_Size  <= 1021){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    if (m_TCP_Window_Size  > 1021){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                    }
                                                 }
                                              }
                                           }
                                        }
                                     }
                                  if (m_TCP_PSH  > 0){
                                     if (m_TCP_Options.mss  <= 1460){
                                        if (m_TCP_Window_Size  <= 440){
                                           if (m_TCP_Window_Size  <= 173){
                                              if (m_TCP_Window_Size  <= 165){
                                                 if (m_TCP_Window_Size  <= 159){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                 if (m_TCP_Window_Size  > 159){m_OS_Version = "Linux Linux 2.6.X"; }
                                                 }
                                              if (m_TCP_Window_Size  > 165){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                              }
                                           if (m_TCP_Window_Size  > 173){
                                              if (m_TCP_Window_Size  <= 192){
                                                 if (m_TCP_Window_Size  <= 190){
                                                    if (m_TCP_Window_Size  <= 176){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                    if (m_TCP_Window_Size  > 176){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 190){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                 }
                                              if (m_TCP_Window_Size  > 192){
                                                 if (m_TCP_Window_Size  <= 429){
                                                    if (m_TCP_Window_Size  <= 219){
                                                       if (m_TCP_Window_Size  <= 215){
                                                          if (m_TCP_Window_Size  <= 201){m_OS_Version = "Linux Linux 2.6.X"; }
                                                          if (m_TCP_Window_Size  > 201){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 215){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 219){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 429){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                 }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 440){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                        }
                                     if (m_TCP_Options.mss  > 1460){
                                        if (m_TCP_Window_Size  <= 183){
                                           if (m_TCP_Window_Size  <= 136){
                                              if (m_TCP_Window_Size  <= 124){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                              if (m_TCP_Window_Size  > 124){
                                                 if (m_TCP_Window_Size  <= 129){
                                                    if (m_TCP_Window_Size  <= 128){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    if (m_TCP_Window_Size  > 128){m_OS_Version = "Linux Linux 2.6.X"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 129){
                                                    if (m_TCP_Window_Size  <= 131){
                                                       if (m_TCP_Window_Size  <= 130){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       if (m_TCP_Window_Size  > 130){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 131){
                                                       if (m_TCP_Window_Size  <= 135){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       if (m_TCP_Window_Size  > 135){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       }
                                                    }
                                                 }
                                              }
                                           if (m_TCP_Window_Size  > 136){
                                              if (m_TCP_Window_Size  <= 137){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Window_Size  > 137){
                                                 if (m_TCP_Window_Size  <= 155){
                                                    if (m_TCP_Window_Size  <= 145){
                                                       if (m_TCP_Window_Size  <= 138){m_OS_Version = "Linux Linux 2.6.X"; }
                                                       if (m_TCP_Window_Size  > 138){
                                                          if (m_TCP_Window_Size  <= 141){
                                                             if (m_TCP_Window_Size  <= 139){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             if (m_TCP_Window_Size  > 139){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 141){
                                                             if (m_TCP_Window_Size  <= 142){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 142){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          }
                                                       }
                                                    if (m_TCP_Window_Size  > 145){
                                                       if (m_TCP_Window_Size  <= 146){m_OS_Version = "Linux Linux 2.6.X"; }
                                                       if (m_TCP_Window_Size  > 146){
                                                          if (m_TCP_Window_Size  <= 154){
                                                             if (m_TCP_Window_Size  <= 149){
                                                                if (m_TCP_Window_Size  <= 147){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                if (m_TCP_Window_Size  > 147){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 149){
                                                                if (m_TCP_Window_Size  <= 152){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 152){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 154){
                                                             if (m_TCP_FIN  <= 0){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 if (m_TCP_Window_Size  > 155){
                                                    if (m_TCP_Window_Size  <= 160){
                                                       if (m_TCP_Window_Size  <= 157){m_OS_Version = "Linux 2.6.32"; }
                                                       if (m_TCP_Window_Size  > 157){
                                                          if (m_TCP_Window_Size  <= 159){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          if (m_TCP_Window_Size  > 159){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       }
                                                    if (m_TCP_Window_Size  > 160){
                                                       if (m_TCP_Window_Size  <= 180){
                                                          if (m_TCP_Window_Size  <= 165){
                                                             if (m_TCP_Window_Size  <= 164){
                                                                if (m_TCP_Window_Size  <= 163){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 163){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 164){m_OS_Version = "Linux 2.6.32"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 165){
                                                             if (m_TCP_Window_Size  <= 178){
                                                                if (m_TCP_Window_Size  <= 172){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                if (m_TCP_Window_Size  > 172){
                                                                   if (m_TCP_Window_Size  <= 173){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 173){
                                                                      if (m_TCP_Window_Size  <= 176){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      if (m_TCP_Window_Size  > 176){
                                                                         if (m_TCP_Window_Size  <= 177){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                         if (m_TCP_Window_Size  > 177){m_OS_Version = "Linux 2.6.32"; }
                                                                         }
                                                                      }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 178){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 180){
                                                          if (m_TCP_Window_Size  <= 182){
                                                             if (m_TCP_Window_Size  <= 181){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             if (m_TCP_Window_Size  > 181){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 182){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       }
                                                    }
                                                 }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 183){
                                           if (m_TCP_Window_Size  <= 423){
                                              if (m_TCP_Window_Size  <= 364){
                                                 if (m_TCP_Window_Size  <= 311){
                                                    if (m_TCP_Window_Size  <= 255){
                                                       if (m_TCP_Window_Size  <= 239){
                                                          if (m_TCP_Window_Size  <= 228){
                                                             if (m_TCP_Window_Size  <= 213){
                                                                if (m_TCP_Window_Size  <= 188){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                if (m_TCP_Window_Size  > 188){
                                                                   if (m_TCP_Window_Size  <= 208){
                                                                      if (m_TCP_Window_Size  <= 204){
                                                                         if (m_TCP_Window_Size  <= 201){
                                                                            if (m_TCP_Window_Size  <= 192){
                                                                               if (m_TCP_Window_Size  <= 190){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                               if (m_TCP_Window_Size  > 190){m_OS_Version = "Linux 2.6.32"; }
                                                                               }
                                                                            if (m_TCP_Window_Size  > 192){
                                                                               if (m_TCP_Window_Size  <= 197){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                               if (m_TCP_Window_Size  > 197){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                               }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 201){
                                                                            if (m_TCP_Window_Size  <= 203){
                                                                               if (m_TCP_Window_Size  <= 202){m_OS_Version = "Linux 2.6.32"; }
                                                                               if (m_TCP_Window_Size  > 202){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                               }
                                                                            if (m_TCP_Window_Size  > 203){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                            }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 204){
                                                                         if (m_TCP_Window_Size  <= 205){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         if (m_TCP_Window_Size  > 205){
                                                                            if (m_TCP_Window_Size  <= 206){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            if (m_TCP_Window_Size  > 206){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                            }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 208){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 213){
                                                                if (m_TCP_Window_Size  <= 216){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                if (m_TCP_Window_Size  > 216){
                                                                   if (m_TCP_Window_Size  <= 227){
                                                                      if (m_TCP_Window_Size  <= 218){m_OS_Version = "Linux 2.6.32"; }
                                                                      if (m_TCP_Window_Size  > 218){
                                                                         if (m_TCP_Window_Size  <= 222){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         if (m_TCP_Window_Size  > 222){
                                                                            if (m_TCP_Window_Size  <= 226){
                                                                               if (m_TCP_Window_Size  <= 225){
                                                                                  if (m_TCP_Window_Size  <= 223){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                                  if (m_TCP_Window_Size  > 223){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                  }
                                                                               if (m_TCP_Window_Size  > 225){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                               }
                                                                            if (m_TCP_Window_Size  > 226){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                            }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 227){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 228){
                                                             if (m_TCP_Window_Size  <= 229){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             if (m_TCP_Window_Size  > 229){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 239){
                                                          if (m_TCP_Window_Size  <= 240){m_OS_Version = "Linux 2.6.32"; }
                                                          if (m_TCP_Window_Size  > 240){
                                                             if (m_TCP_Window_Size  <= 252){
                                                                if (m_TCP_Window_Size  <= 250){
                                                                   if (m_TCP_Window_Size  <= 249){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   if (m_TCP_Window_Size  > 249){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 250){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 252){
                                                                if (m_TCP_Window_Size  <= 253){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 253){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    if (m_TCP_Window_Size  > 255){
                                                       if (m_TCP_Window_Size  <= 256){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       if (m_TCP_Window_Size  > 256){
                                                          if (m_TCP_Window_Size  <= 273){
                                                             if (m_TCP_Window_Size  <= 272){
                                                                if (m_TCP_Window_Size  <= 257){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 257){
                                                                   if (m_TCP_Window_Size  <= 271){
                                                                      if (m_TCP_Window_Size  <= 262){
                                                                         if (m_TCP_Window_Size  <= 259){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         if (m_TCP_Window_Size  > 259){m_OS_Version = "Linux 2.6.32"; }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 262){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 271){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 272){m_OS_Version = "Linux 2.6.32"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 273){
                                                             if (m_TCP_Window_Size  <= 305){
                                                                if (m_TCP_Window_Size  <= 289){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                if (m_TCP_Window_Size  > 289){
                                                                   if (m_TCP_Window_Size  <= 296){
                                                                      if (m_TCP_Window_Size  <= 292){m_OS_Version = "Linux 2.6.32"; }
                                                                      if (m_TCP_Window_Size  > 292){
                                                                         if (m_TCP_Window_Size  <= 295){
                                                                            if (m_TCP_Window_Size  <= 293){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            if (m_TCP_Window_Size  > 293){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 295){m_OS_Version = "Linux 2.6.32"; }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 296){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 305){
                                                                if (m_TCP_Window_Size  <= 310){
                                                                   if (m_TCP_Window_Size  <= 309){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   if (m_TCP_Window_Size  > 309){m_OS_Version = "Linux 2.6.32"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 310){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 if (m_TCP_Window_Size  > 311){
                                                    if (m_TCP_Window_Size  <= 312){m_OS_Version = "Linux Linux 2.6.X"; }
                                                    if (m_TCP_Window_Size  > 312){
                                                       if (m_TCP_Window_Size  <= 321){
                                                          if (m_TCP_Window_Size  <= 314){m_OS_Version = "Linux Linux 2.6.X"; }
                                                          if (m_TCP_Window_Size  > 314){
                                                             if (m_TCP_Window_Size  <= 319){
                                                                if (m_TCP_Window_Size  <= 317){
                                                                   if (m_TCP_Window_Size  <= 316){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 316){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 317){m_OS_Version = "Linux 2.6.32"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 319){m_OS_Version = "Linux 2.6.32"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 321){
                                                          if (m_TCP_Window_Size  <= 357){
                                                             if (m_TCP_Window_Size  <= 346){
                                                                if (m_TCP_Window_Size  <= 339){
                                                                   if (m_TCP_Window_Size  <= 334){
                                                                      if (m_TCP_Window_Size  <= 331){
                                                                         if (m_TCP_Window_Size  <= 322){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                                                                         if (m_TCP_Window_Size  > 322){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 331){m_OS_Version = "Linux 2.6.32"; }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 334){
                                                                      if (m_TCP_Window_Size  <= 337){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                      if (m_TCP_Window_Size  > 337){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                                                                      }
                                                                   }
                                                                if (m_TCP_Window_Size  > 339){
                                                                   if (m_TCP_Window_Size  <= 340){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   if (m_TCP_Window_Size  > 340){
                                                                      if (m_TCP_Window_Size  <= 341){m_OS_Version = "Linux 2.6.32"; }
                                                                      if (m_TCP_Window_Size  > 341){
                                                                         if (m_TCP_Window_Size  <= 345){
                                                                            if (m_TCP_Window_Size  <= 343){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            if (m_TCP_Window_Size  > 343){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 345){m_OS_Version = "Linux 2.6.32"; }
                                                                         }
                                                                      }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 346){
                                                                if (m_TCP_Window_Size  <= 353){
                                                                   if (m_TCP_Window_Size  <= 349){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                                                                   if (m_TCP_Window_Size  > 349){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 353){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 357){
                                                             if (m_TCP_Window_Size  <= 363){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             if (m_TCP_Window_Size  > 363){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 }
                                              if (m_TCP_Window_Size  > 364){
                                                 if (m_TCP_Window_Size  <= 367){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                 if (m_TCP_Window_Size  > 367){
                                                    if (m_TCP_Window_Size  <= 377){
                                                       if (m_TCP_Window_Size  <= 375){
                                                          if (m_TCP_Window_Size  <= 372){
                                                             if (m_TCP_Window_Size  <= 370){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 370){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 372){
                                                             if (m_TCP_Window_Size  <= 373){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             if (m_TCP_Window_Size  > 373){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 375){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 377){
                                                       if (m_TCP_Window_Size  <= 383){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       if (m_TCP_Window_Size  > 383){
                                                          if (m_TCP_Window_Size  <= 406){
                                                             if (m_TCP_Window_Size  <= 404){
                                                                if (m_TCP_Window_Size  <= 397){
                                                                   if (m_TCP_Window_Size  <= 395){
                                                                      if (m_TCP_Window_Size  <= 389){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      if (m_TCP_Window_Size  > 389){
                                                                         if (m_TCP_Window_Size  <= 393){m_OS_Version = "Linux 2.6.32"; }
                                                                         if (m_TCP_Window_Size  > 393){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 395){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 397){
                                                                   if (m_TCP_Window_Size  <= 399){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                   if (m_TCP_Window_Size  > 399){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 404){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 406){
                                                             if (m_TCP_Window_Size  <= 422){
                                                                if (m_TCP_Window_Size  <= 414){
                                                                   if (m_TCP_Window_Size  <= 411){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   if (m_TCP_Window_Size  > 411){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                if (m_TCP_Window_Size  > 414){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 422){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 }
                                              }
                                           if (m_TCP_Window_Size  > 423){
                                              if (m_TCP_Window_Size  <= 702){
                                                 if (m_TCP_Window_Size  <= 575){
                                                    if (m_TCP_Window_Size  <= 429){
                                                       if (m_TCP_Window_Size  <= 426){
                                                          if (m_TCP_Window_Size  <= 425){
                                                             if (m_TCP_Window_Size  <= 424){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 424){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 425){m_OS_Version = "Linux Linux 2.6.X"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 426){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 429){
                                                       if (m_TCP_Window_Size  <= 499){
                                                          if (m_TCP_Window_Size  <= 447){
                                                             if (m_TCP_Window_Size  <= 441){
                                                                if (m_TCP_Window_Size  <= 432){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                if (m_TCP_Window_Size  > 432){
                                                                   if (m_TCP_Window_Size  <= 434){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   if (m_TCP_Window_Size  > 434){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 441){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 447){
                                                             if (m_TCP_Window_Size  <= 492){
                                                                if (m_TCP_Window_Size  <= 469){
                                                                   if (m_TCP_Window_Size  <= 456){
                                                                      if (m_TCP_Window_Size  <= 452){
                                                                         if (m_TCP_Window_Size  <= 448){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         if (m_TCP_Window_Size  > 448){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 452){
                                                                         if (m_TCP_Window_Size  <= 455){
                                                                            if (m_TCP_Window_Size  <= 454){m_OS_Version = "Linux 2.6.32"; }
                                                                            if (m_TCP_Window_Size  > 454){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 455){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         }
                                                                      }
                                                                   if (m_TCP_Window_Size  > 456){
                                                                      if (m_TCP_Window_Size  <= 458){
                                                                         if (m_TCP_Window_Size  <= 457){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         if (m_TCP_Window_Size  > 457){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         }
                                                                      if (m_TCP_Window_Size  > 458){
                                                                         if (m_TCP_Window_Size  <= 468){
                                                                            if (m_TCP_Window_Size  <= 463){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            if (m_TCP_Window_Size  > 463){
                                                                               if (m_TCP_Window_Size  <= 466){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                               if (m_TCP_Window_Size  > 466){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                               }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 468){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                         }
                                                                      }
                                                                   }
                                                                if (m_TCP_Window_Size  > 469){
                                                                   if (m_TCP_Window_Size  <= 471){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   if (m_TCP_Window_Size  > 471){
                                                                      if (m_TCP_Window_Size  <= 475){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 475){
                                                                         if (m_TCP_Window_Size  <= 480){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         if (m_TCP_Window_Size  > 480){
                                                                            if (m_TCP_Window_Size  <= 482){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                            if (m_TCP_Window_Size  > 482){
                                                                               if (m_TCP_Window_Size  <= 489){
                                                                                  if (m_TCP_FIN  <= 0){
                                                                                     if (m_TCP_Window_Size  <= 486){m_OS_Version = "Linux 2.6.32"; }
                                                                                     if (m_TCP_Window_Size  > 486){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                                     }
                                                                                  if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                                  }
                                                                               if (m_TCP_Window_Size  > 489){
                                                                                  if (m_TCP_Window_Size  <= 491){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                                                                                  if (m_TCP_Window_Size  > 491){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                                  }
                                                                               }
                                                                            }
                                                                         }
                                                                      }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 492){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 499){
                                                          if (m_TCP_Window_Size  <= 504){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                          if (m_TCP_Window_Size  > 504){
                                                             if (m_TCP_Window_Size  <= 537){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 537){
                                                                if (m_TCP_Window_Size  <= 543){m_OS_Version = "Linux 2.6.24 - 2.6.35"; }
                                                                if (m_TCP_Window_Size  > 543){
                                                                   if (m_TCP_Window_Size  <= 552){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 552){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   }
                                                                }
                                                             }
                                                          }
                                                       }
                                                    }
                                                 if (m_TCP_Window_Size  > 575){
                                                    if (m_TCP_Window_Size  <= 611){
                                                       if (m_TCP_Window_Size  <= 601){
                                                          if (m_TCP_Window_Size  <= 582){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                          if (m_TCP_Window_Size  > 582){
                                                             if (m_TCP_Window_Size  <= 583){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 583){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 601){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 611){
                                                       if (m_TCP_Window_Size  <= 684){
                                                          if (m_TCP_Window_Size  <= 619){
                                                             if (m_TCP_Window_Size  <= 615){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             if (m_TCP_Window_Size  > 615){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 619){
                                                             if (m_TCP_Window_Size  <= 682){
                                                                if (m_TCP_Window_Size  <= 632){
                                                                   if (m_TCP_Window_Size  <= 624){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   if (m_TCP_Window_Size  > 624){
                                                                      if (m_TCP_Window_Size  <= 630){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                      if (m_TCP_Window_Size  > 630){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      }
                                                                   }
                                                                if (m_TCP_Window_Size  > 632){
                                                                   if (m_TCP_Window_Size  <= 640){m_OS_Version = "Linux 2.6.32"; }
                                                                   if (m_TCP_Window_Size  > 640){
                                                                      if (m_TCP_Window_Size  <= 651){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                      if (m_TCP_Window_Size  > 651){
                                                                         if (m_TCP_Window_Size  <= 670){
                                                                            if (m_TCP_Window_Size  <= 665){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                            if (m_TCP_Window_Size  > 665){m_OS_Version = "Linux 2.6.32"; }
                                                                            }
                                                                         if (m_TCP_Window_Size  > 670){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                         }
                                                                      }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 682){m_OS_Version = "Linux Linux 2.6.X"; }
                                                             }
                                                          }
                                                       if (m_TCP_Window_Size  > 684){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       }
                                                    }
                                                 }
                                              if (m_TCP_Window_Size  > 702){
                                                 if (m_TCP_Window_Size  <= 970){
                                                    if (m_TCP_Window_Size  <= 733){
                                                       if (m_TCP_Window_Size  <= 730){
                                                          if (m_TCP_Window_Size  <= 728){
                                                             if (m_TCP_Window_Size  <= 726){
                                                                if (m_TCP_Window_Size  <= 715){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 715){
                                                                   if (m_TCP_Window_Size  <= 717){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                   if (m_TCP_Window_Size  > 717){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                   }
                                                                }
                                                             if (m_TCP_Window_Size  > 726){m_OS_Version = "Linux 2.6.32"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 728){m_OS_Version = "Linux Linux 2.6.X"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 730){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 733){
                                                       if (m_TCP_Window_Size  <= 806){m_OS_Version = "Linux 2.6.32"; }
                                                       if (m_TCP_Window_Size  > 806){
                                                          if (m_TCP_Window_Size  <= 908){
                                                             if (m_TCP_Window_Size  <= 863){
                                                                if (m_TCP_Window_Size  <= 829){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                                if (m_TCP_Window_Size  > 829){m_OS_Version = "Linux Linux 2.6.X"; }
                                                                }
                                                             if (m_TCP_Window_Size  > 863){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 908){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       }
                                                    }
                                                 if (m_TCP_Window_Size  > 970){
                                                    if (m_TCP_Window_Size  <= 1002){
                                                       if (m_TCP_Window_Size  <= 985){
                                                          if (m_TCP_Window_Size  <= 975){m_OS_Version = "Linux Linux 2.6.X"; }
                                                          if (m_TCP_Window_Size  > 975){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 985){m_OS_Version = "Linux Linux 2.6.X"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 1002){
                                                       if (m_TCP_Window_Size  <= 1023){
                                                          if (m_TCP_Window_Size  <= 1018){m_OS_Version = "Linux 2.6.32"; }
                                                          if (m_TCP_Window_Size  > 1018){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 1023){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       }
                                                    }
                                                 }
                                              }
                                           }
                                        }
                                     }
                                  }
                               if (m_TCP_Window_Size  > 1034){
                                  if (m_TCP_Options.nop_set  <= 1){
                                     if (m_TCP_Window_Size  <= 5454){
                                        if (m_TCP_PSH  <= 0){
                                           if (m_TCP_Window_Size  <= 1224){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                           if (m_TCP_Window_Size  > 1224){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                           }
                                        if (m_TCP_PSH  > 0){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                        }
                                     if (m_TCP_Window_Size  > 5454){m_OS_Version = "Linux Linux 2.6.X"; }
                                     }
                                  if (m_TCP_Options.nop_set  > 1){
                                     if (m_TCP_Window_Size  <= 3391){
                                        if (m_TCP_Window_Size  <= 2436){
                                           if (m_TCP_Window_Size  <= 1538){
                                              if (m_TCP_Window_Size  <= 1428){
                                                 if (m_TCP_Window_Size  <= 1144){
                                                    if (m_TCP_Window_Size  <= 1111){
                                                       if (m_TCP_Window_Size  <= 1045){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                       if (m_TCP_Window_Size  > 1045){
                                                          if (m_TCP_Window_Size  <= 1090){
                                                             if (m_TCP_Window_Size  <= 1086){m_OS_Version = "Linux 2.6.32"; }
                                                             if (m_TCP_Window_Size  > 1086){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                             }
                                                          if (m_TCP_Window_Size  > 1090){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       }
                                                    if (m_TCP_Window_Size  > 1111){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                    }
                                                 if (m_TCP_Window_Size  > 1144){
                                                    if (m_TCP_Window_Size  <= 1369){
                                                       if (m_TCP_Window_Size  <= 1277){
                                                          if (m_TCP_Window_Size  <= 1270){
                                                             if (m_TCP_Window_Size  <= 1209){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                             if (m_TCP_Window_Size  > 1209){
                                                                if (m_TCP_Window_Size  <= 1211){m_OS_Version = "Linux 2.6.32"; }
                                                                if (m_TCP_Window_Size  > 1211){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                                }
                                                             }
                                                          if (m_TCP_Window_Size  > 1270){m_OS_Version = "Linux 2.6.32"; }
                                                          }
                                                       if (m_TCP_Window_Size  > 1277){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       }
                                                    if (m_TCP_Window_Size  > 1369){m_OS_Version = "Linux 2.6.32"; }
                                                    }
                                                 }
                                              if (m_TCP_Window_Size  > 1428){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                              }
                                           if (m_TCP_Window_Size  > 1538){
                                              if (m_TCP_Window_Size  <= 2089){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Window_Size  > 2089){
                                                 if (m_TCP_Window_Size  <= 2165){m_OS_Version = "Linux 2.6.32"; }
                                                 if (m_TCP_Window_Size  > 2165){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                 }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 2436){
                                           if (m_TCP_Window_Size  <= 3027){
                                              if (m_TCP_Window_Size  <= 2896){
                                                 if (m_TCP_Window_Size  <= 2856){m_OS_Version = "Linux Linux 2.6.X"; }
                                                 if (m_TCP_Window_Size  > 2856){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                 }
                                              if (m_TCP_Window_Size  > 2896){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                              }
                                           if (m_TCP_Window_Size  > 3027){
                                              if (m_TCP_Window_Size  <= 3076){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Window_Size  > 3076){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                              }
                                           }
                                        }
                                     if (m_TCP_Window_Size  > 3391){
                                        if (m_TCP_Window_Size  <= 4452){
                                           if (m_TCP_PSH  <= 0){
                                              if (m_TCP_Window_Size  <= 3864){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Window_Size  > 3864){
                                                 if (m_TCP_Window_Size  <= 4344){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                 if (m_TCP_Window_Size  > 4344){m_OS_Version = "Linux 2.6.32"; }
                                                 }
                                              }
                                           if (m_TCP_PSH  > 0){m_OS_Version = "Linux 2.6.32"; }
                                           }
                                        if (m_TCP_Window_Size  > 4452){
                                           if (m_TCP_Window_Size  <= 5956){
                                              if (m_TCP_Window_Size  <= 5839){
                                                 if (m_TCP_Window_Size  <= 5788){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                 if (m_TCP_Window_Size  > 5788){
                                                    if (m_TCP_Window_Size  <= 5792){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                    if (m_TCP_Window_Size  > 5792){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    }
                                                 }
                                              if (m_TCP_Window_Size  > 5839){
                                                 if (m_TCP_Window_Size  <= 5840){m_OS_Version = "Linux Linux 2.6.X"; }
                                                 if (m_TCP_Window_Size  > 5840){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                 }
                                              }
                                           if (m_TCP_Window_Size  > 5956){
                                              if (m_TCP_Window_Size  <= 6147){
                                                 if (m_TCP_Window_Size  <= 6054){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                 if (m_TCP_Window_Size  > 6054){m_OS_Version = "Linux 2.6.32"; }
                                                 }
                                              if (m_TCP_Window_Size  > 6147){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                              }
                                           }
                                        }
                                     }
                                  }
                               }
                            if (m_IP_TOS  > 0){
                               if (m_IP_TOS  <= 2){
                                  if (m_TCP_Window_Size  <= 504){m_OS_Version = "Linux 2.6.32"; }
                                  if (m_TCP_Window_Size  > 504){
                                     if (m_TCP_Window_Size  <= 1716){
                                        if (m_TCP_Window_Size  <= 1427){
                                           if (m_TCP_Window_Size  <= 517){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                           if (m_TCP_Window_Size  > 517){
                                              if (m_TCP_Window_Size  <= 829){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Window_Size  > 829){
                                                 if (m_TCP_Window_Size  <= 1369){
                                                    if (m_TCP_Window_Size  <= 1002){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                    if (m_TCP_Window_Size  > 1002){
                                                       if (m_TCP_Window_Size  <= 1195){m_OS_Version = "Linux 2.6.32"; }
                                                       if (m_TCP_Window_Size  > 1195){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       }
                                                    }
                                                 if (m_TCP_Window_Size  > 1369){
                                                    if (m_TCP_Window_Size  <= 1383){m_OS_Version = "Linux 2.6.32"; }
                                                    if (m_TCP_Window_Size  > 1383){
                                                       if (m_TCP_Window_Size  <= 1419){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                                       if (m_TCP_Window_Size  > 1419){m_OS_Version = "Linux 2.6.32"; }
                                                       }
                                                    }
                                                 }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 1427){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                        }
                                     if (m_TCP_Window_Size  > 1716){m_OS_Version = "Linux 2.6.32"; }
                                     }
                                  }
                               if (m_IP_TOS  > 2){
                                  if (m_TCP_Window_Size  <= 496){
                                     if (m_TCP_Window_Size  <= 208){m_OS_Version = "Linux Linux 2.6.X"; }
                                     if (m_TCP_Window_Size  > 208){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                     }
                                  if (m_TCP_Window_Size  > 496){m_OS_Version = "Linux 2.6.32"; }
                                  }
                               }
                            }
                         if (m_IP_TOS  > 8){
                            if (m_TCP_Window_Size  <= 216){
                               if (m_TCP_Window_Size  <= 155){
                                  if (m_TCP_Window_Size  <= 144){
                                     if (m_TCP_Window_Size  <= 137){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                     if (m_TCP_Window_Size  > 137){m_OS_Version = "Linux Linux 2.6.X"; }
                                     }
                                  if (m_TCP_Window_Size  > 144){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                  }
                               if (m_TCP_Window_Size  > 155){
                                  if (m_TCP_Window_Size  <= 178){
                                     if (m_TCP_Window_Size  <= 166){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                     if (m_TCP_Window_Size  > 166){m_OS_Version = "Linux Linux 2.4.X"; }
                                     }
                                  if (m_TCP_Window_Size  > 178){
                                     if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                     if (m_TCP_Options.mss  > 1460){m_OS_Version = "Linux Linux 2.6.X"; }
                                     }
                                  }
                               }
                            if (m_TCP_Window_Size  > 216){
                               if (m_TCP_Window_Size  <= 303){
                                  if (m_TCP_Window_Size  <= 272){
                                     if (m_TCP_Window_Size  <= 264){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                     if (m_TCP_Window_Size  > 264){m_OS_Version = "Linux 2.6.32"; }
                                     }
                                  if (m_TCP_Window_Size  > 272){
                                     if (m_TCP_Window_Size  <= 283){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                     if (m_TCP_Window_Size  > 283){m_OS_Version = "Linux 2.6.19 - 2.6.36"; }
                                     }
                                  }
                               if (m_TCP_Window_Size  > 303){
                                  if (m_TCP_Window_Size  <= 657){
                                     if (m_TCP_Window_Size  <= 331){m_OS_Version = "Linux Linux 2.6.X"; }
                                     if (m_TCP_Window_Size  > 331){
                                        if (m_TCP_Window_Size  <= 461){
                                           if (m_TCP_Window_Size  <= 347){m_OS_Version = "Linux 2.6.32"; }
                                           if (m_TCP_Window_Size  > 347){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                           }
                                        if (m_TCP_Window_Size  > 461){
                                           if (m_TCP_Window_Size  <= 529){m_OS_Version = "Linux 2.6.32"; }
                                           if (m_TCP_Window_Size  > 529){
                                              if (m_TCP_PSH  <= 0){
                                                 if (m_TCP_Window_Size  <= 629){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                                 if (m_TCP_Window_Size  > 629){m_OS_Version = "Linux 2.6.32"; }
                                                 }
                                              if (m_TCP_PSH  > 0){m_OS_Version = "Linux Linux 2.6.X"; }
                                              }
                                           }
                                        }
                                     }
                                  if (m_TCP_Window_Size  > 657){
                                     if (m_TCP_Window_Size  <= 1495){
                                        if (m_TCP_Window_Size  <= 1045){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                        if (m_TCP_Window_Size  > 1045){m_OS_Version = "Linux Linux 2.6.X"; }
                                        }
                                     if (m_TCP_Window_Size  > 1495){
                                        if (m_TCP_Window_Size  <= 2154){
                                           if (m_TCP_Window_Size  <= 1943){m_OS_Version = "Linux 2.6.32"; }
                                           if (m_TCP_Window_Size  > 1943){m_OS_Version = "Linux 2.6.16 - 2.6.28"; }
                                           }
                                        if (m_TCP_Window_Size  > 2154){
                                           if (m_TCP_Window_Size  <= 2436){
                                              if (m_TCP_Window_Size  <= 2155){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                              if (m_TCP_Window_Size  > 2155){m_OS_Version = "Linux 2.6.32"; }
                                              }
                                           if (m_TCP_Window_Size  > 2436){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                           }
                                        }
                                     }
                                  }
                               }
                            }
                         }
                      }
                   }
                }
             if (m_TCP_Window_Size  > 6150){
                if (m_TCP_Options.timestamp_set  <= 0){
                   if (m_IP_TTL  <= 64){
                      if (m_TCP_Window_Size  <= 10880){
                         if (m_TCP_PSH  <= 0){
                            if (m_TCP_Window_Size  <= 7252){
                               if (m_TCP_Window_Size  <= 6432){m_OS_Version = "Linux Linux 2.6.X"; }
                               if (m_TCP_Window_Size  > 6432){
                                  if (m_TCP_Window_Size  <= 7041){m_OS_Version = "Linux 2.6.32"; }
                                  if (m_TCP_Window_Size  > 7041){
                                     if (m_TCP_Window_Size  <= 7062){m_OS_Version = "Linux Linux 2.6.X"; }
                                     if (m_TCP_Window_Size  > 7062){
                                        if (m_TCP_Window_Size  <= 7115){m_OS_Version = "Linux 2.6.32"; }
                                        if (m_TCP_Window_Size  > 7115){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                        }
                                     }
                                  }
                               }
                            if (m_TCP_Window_Size  > 7252){m_OS_Version = "Linux Linux 2.6.X"; }
                            }
                         if (m_TCP_PSH  > 0){
                            if (m_TCP_Window_Size  <= 6968){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                            if (m_TCP_Window_Size  > 6968){
                               if (m_TCP_Window_Size  <= 9648){
                                  if (m_TCP_Window_Size  <= 9024){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  if (m_TCP_Window_Size  > 9024){m_OS_Version = "Linux Linux 2.6.X"; }
                                  }
                               if (m_TCP_Window_Size  > 9648){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                               }
                            }
                         }
                      if (m_TCP_Window_Size  > 10880){
                         if (m_TCP_PSH  <= 0){
                            if (m_TCP_Window_Size  <= 14600){m_OS_Version = "Linux 2.6.32"; }
                            if (m_TCP_Window_Size  > 14600){
                               if (m_TCP_Window_Size  <= 16080){
                                  if (m_TCP_FIN  <= 0){m_OS_Version = "Linux Linux 2.4.X"; }
                                  if (m_TCP_FIN  > 0){m_OS_Version = "Linux 2.6.32"; }
                                  }
                               if (m_TCP_Window_Size  > 16080){
                                  if (m_TCP_FIN  <= 0){
                                     if (m_TCP_Window_Size  <= 51456){m_OS_Version = "Linux 2.6.32"; }
                                     if (m_TCP_Window_Size  > 51456){
                                        if (m_TCP_Window_Size  <= 63784){
                                           if (m_TCP_Window_Size  <= 60032){m_OS_Version = "Linux Linux 2.6.X"; }
                                           if (m_TCP_Window_Size  > 60032){
                                              if (m_TCP_Window_Size  <= 63618){m_OS_Version = "Linux 2.6.32"; }
                                              if (m_TCP_Window_Size  > 63618){m_OS_Version = "Linux Linux 2.6.X"; }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 63784){m_OS_Version = "Linux 2.6.32"; }
                                        }
                                     }
                                  if (m_TCP_FIN  > 0){
                                     if (m_TCP_Window_Size  <= 25840){
                                        if (m_TCP_Window_Size  <= 22179){
                                           if (m_TCP_Window_Size  <= 16698){m_OS_Version = "Linux 2.6.32"; }
                                           if (m_TCP_Window_Size  > 16698){
                                              if (m_TCP_Window_Size  <= 17152){m_OS_Version = "Linux Linux 2.6.X"; }
                                              if (m_TCP_Window_Size  > 17152){m_OS_Version = "Linux 2.6.32"; }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 22179){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                        }
                                     if (m_TCP_Window_Size  > 25840){
                                        if (m_TCP_Window_Size  <= 41808){m_OS_Version = "Linux Linux 2.6.X"; }
                                        if (m_TCP_Window_Size  > 41808){m_OS_Version = "Linux 2.6.32"; }
                                        }
                                     }
                                  }
                               }
                            }
                         if (m_TCP_PSH  > 0){
                            if (m_TCP_Window_Size  <= 24576){
                               if (m_TCP_Window_Size  <= 23584){
                                  if (m_TCP_Window_Size  <= 18224){
                                     if (m_TCP_Window_Size  <= 15540){
                                        if (m_TCP_Window_Size  <= 15008){
                                           if (m_TCP_Window_Size  <= 11792){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                           if (m_TCP_Window_Size  > 11792){
                                              if (m_TCP_Window_Size  <= 13995){m_OS_Version = "Linux Linux 2.6.X"; }
                                              if (m_TCP_Window_Size  > 13995){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                              }
                                           }
                                        if (m_TCP_Window_Size  > 15008){m_OS_Version = "Linux 2.6.32"; }
                                        }
                                     if (m_TCP_Window_Size  > 15540){
                                        if (m_TCP_Window_Size  <= 15696){m_OS_Version = "Linux Linux 2.4.X"; }
                                        if (m_TCP_Window_Size  > 15696){m_OS_Version = "Linux Linux 2.6.X"; }
                                        }
                                     }
                                  if (m_TCP_Window_Size  > 18224){
                                     if (m_TCP_Window_Size  <= 19024){m_OS_Version = "Linux 2.6.32"; }
                                     if (m_TCP_Window_Size  > 19024){m_OS_Version = "Linux Linux 2.6.X"; }
                                     }
                                  }
                               if (m_TCP_Window_Size  > 23584){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                               }
                            if (m_TCP_Window_Size  > 24576){
                               if (m_TCP_Window_Size  <= 63784){
                                  if (m_TCP_Window_Size  <= 63618){
                                     if (m_TCP_Window_Size  <= 62176){
                                        if (m_TCP_Window_Size  <= 25840){
                                           if (m_TCP_Window_Size  <= 25728){m_OS_Version = "Linux Linux 2.6.X"; }
                                           if (m_TCP_Window_Size  > 25728){m_OS_Version = "Linux 2.6.32"; }
                                           }
                                        if (m_TCP_Window_Size  > 25840){m_OS_Version = "Linux Linux 2.6.X"; }
                                        }
                                     if (m_TCP_Window_Size  > 62176){m_OS_Version = "Linux 2.6.32"; }
                                     }
                                  if (m_TCP_Window_Size  > 63618){m_OS_Version = "Linux Linux 2.6.X"; }
                                  }
                               if (m_TCP_Window_Size  > 63784){m_OS_Version = "Linux 2.6.32"; }
                               }
                            }
                         }
                      }
                   if (m_IP_TTL  > 64){m_OS_Version = "Linux Linux 2.6.X"; }
                   }
                if (m_TCP_Options.timestamp_set  > 0){
                   if (m_TCP_Window_Size  <= 38592){
                      if (m_IP_TOS  <= 8){
                         if (m_IP_TOS  <= 2){
                            if (m_TCP_Window_Size  <= 20006){
                               if (m_TCP_Window_Size  <= 8260){
                                  if (m_TCP_Window_Size  <= 7236){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                  if (m_TCP_Window_Size  > 7236){
                                     if (m_TCP_Window_Size  <= 7240){m_OS_Version = "Linux Linux 2.4.X"; }
                                     if (m_TCP_Window_Size  > 7240){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                                     }
                                  }
                               if (m_TCP_Window_Size  > 8260){
                                  if (m_TCP_Window_Size  <= 11792){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                                  if (m_TCP_Window_Size  > 11792){m_OS_Version = "Linux 2.6.32"; }
                                  }
                               }
                            if (m_TCP_Window_Size  > 20006){
                               if (m_TCP_Window_Size  <= 25840){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                               if (m_TCP_Window_Size  > 25840){m_OS_Version = "Linux 2.6.32"; }
                               }
                            }
                         if (m_IP_TOS  > 2){
                            if (m_TCP_Window_Size  <= 12864){m_OS_Version = "Linux Linux 2.4.X"; }
                            if (m_TCP_Window_Size  > 12864){m_OS_Version = "Linux 2.6.32"; }
                            }
                         }
                      if (m_IP_TOS  > 8){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                      }
                   if (m_TCP_Window_Size  > 38592){
                      if (m_TCP_Window_Size  <= 56816){
                         if (m_TCP_Window_Size  <= 47168){
                            if (m_TCP_Window_Size  <= 42880){m_OS_Version = "Linux Linux 2.4.X"; }
                            if (m_TCP_Window_Size  > 42880){m_OS_Version = "Linux Linux 2.6.X"; }
                            }
                         if (m_TCP_Window_Size  > 47168){m_OS_Version = "Linux Linux 2.4.X"; }
                         }
                      if (m_TCP_Window_Size  > 56816){
                         if (m_TCP_Window_Size  <= 65532){m_OS_Version = "Linux 2.6.32"; }
                         if (m_TCP_Window_Size  > 65532){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                         }
                      }
                   }
                }
             }
          if (m_TCP_ACK == true && m_TCP_SYN == true){
             if (m_TCP_Window_Size  <= 9648){
                if (m_TCP_Options.window_scale  <= 6){
                   if (m_TCP_Options.window_scale  <= 3){m_OS_Version = "Linux Linux 2.6.X"; }
                   if (m_TCP_Options.window_scale  > 3){m_OS_Version = "Linux 2.6.15 - 2.6.26"; }
                   }
                if (m_TCP_Options.window_scale  > 6){
                   if (m_TCP_Options.nop_set  <= 2){m_OS_Version = "Linux Linux 2.6.X"; }
                   if (m_TCP_Options.nop_set  > 2){
                      if (m_TCP_Window_Size  <= 5811){m_OS_Version = "Linux 2.6.32"; }
                      if (m_TCP_Window_Size  > 5811){m_OS_Version = "Linux Linux 2.6.X"; }
                      }
                   }
                }
             if (m_TCP_Window_Size  > 9648){
                if (m_TCP_Window_Size  <= 14480){
                   if (m_TCP_Options.window_scale  <= 4){m_OS_Version = "Linux Linux 2.4.X"; }
                   if (m_TCP_Options.window_scale  > 4){m_OS_Version = "Linux 2.6.32"; }
                   }
                if (m_TCP_Window_Size  > 14480){m_OS_Version = "Linux Linux 2.4.X"; }
                }
             }
          if (m_TCP_ACK == false && m_TCP_SYN == true){
             if (m_TCP_Options.window_scale  <= 6){
                if (m_TCP_Window_Size  <= 7012){
                   if (m_TCP_Options.window_scale  <= 5){
                      if (m_TCP_Options.window_scale  <= 4){
                         if (m_TCP_Options.window_scale  <= 1){m_OS_Version = "Acorp W400G or W422G wireless ADSL modem (MontaVista embedded Linux 2.4.17)"; }
                         if (m_TCP_Options.window_scale  > 1){m_OS_Version = "Linux 2.6.16 - 2.6.28"; }
                         }
                      if (m_TCP_Options.window_scale  > 4){m_OS_Version = "Linux 2.6.9 - 2.6.27"; }
                      }
                   if (m_TCP_Options.window_scale  > 5){m_OS_Version = "Linux 2.6.32"; }
                   }
                if (m_TCP_Window_Size  > 7012){
                   if (m_TCP_Options.window_scale  <= 1){
                      if (m_IP_TTL  <= 64){
                         if (m_TCP_Window_Size  <= 39664){m_OS_Version = "Linux Linux 2.4.X"; }
                         if (m_TCP_Window_Size  > 39664){m_OS_Version = "Linux 2.6.32"; }
                         }
                      if (m_IP_TTL  > 64){m_OS_Version = "Linux Linux 2.6.X"; }
                      }
                   if (m_TCP_Options.window_scale  > 1){
                      if (m_IP_TTL  <= 64){
                         if (m_TCP_Options.window_scale  <= 5){m_OS_Version = "Linux 2.6.32"; }
                         if (m_TCP_Options.window_scale  > 5){m_OS_Version = "Linux Linux 2.6.X"; }
                         }
                      if (m_IP_TTL  > 64){m_OS_Version = "Linux Linux 2.6.X"; }
                      }
                   }
                }
             if (m_TCP_Options.window_scale  > 6){
                if (m_TCP_Window_Size  <= 10220){
                   if (m_TCP_Options.window_scale  <= 7){m_OS_Version = "Linux 2.6.32"; }
                   if (m_TCP_Options.window_scale  > 7){
                      if (m_TCP_Options.window_scale  <= 8){m_OS_Version = "Linux Linux 2.6.X"; }
                      if (m_TCP_Options.window_scale  > 8){m_OS_Version = "Linux 2.6.17 - 2.6.35"; }
                      }
                   }
                if (m_TCP_Window_Size  > 10220){m_OS_Version = "Linux 2.6.32"; }
                }
             }
          }
       }
    if (m_OS_Type == "Mac"){
       if (m_TCP_Window_Size  <= 32876){
          if (m_TCP_Window_Size  <= 32832){
             if (m_TCP_Options.nop_set  <= 3){
                if (m_TCP_Window_Size  <= 32666){
                   if (m_TCP_Window_Size  <= 31856){
                      if (m_TCP_Window_Size  <= 31844){m_OS_Version = "Apple iOS 4.1"; }
                      if (m_TCP_Window_Size  > 31844){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                      }
                   if (m_TCP_Window_Size  > 31856){
                      if (m_TCP_Window_Size  <= 32297){m_OS_Version = "Apple iOS 4.1"; }
                      if (m_TCP_Window_Size  > 32297){
                         if (m_TCP_Window_Size  <= 32627){
                            if (m_TCP_Window_Size  <= 32610){
                               if (m_TCP_Window_Size  <= 32580){
                                  if (m_TCP_Window_Size  <= 32347){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  if (m_TCP_Window_Size  > 32347){
                                     if (m_TCP_Window_Size  <= 32467){m_OS_Version = "Apple iOS 4.1"; }
                                     if (m_TCP_Window_Size  > 32467){
                                        if (m_TCP_Window_Size  <= 32574){
                                           if (m_TCP_Window_Size  <= 32521){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                           if (m_TCP_Window_Size  > 32521){m_OS_Version = "Apple iOS 4.1"; }
                                           }
                                        if (m_TCP_Window_Size  > 32574){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                        }
                                     }
                                  }
                               if (m_TCP_Window_Size  > 32580){m_OS_Version = "Apple iOS 4.1"; }
                               }
                            if (m_TCP_Window_Size  > 32610){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                            }
                         if (m_TCP_Window_Size  > 32627){m_OS_Version = "Apple iOS 4.1"; }
                         }
                      }
                   }
                if (m_TCP_Window_Size  > 32666){
                   if (m_TCP_Window_Size  <= 32684){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                   if (m_TCP_Window_Size  > 32684){
                      if (m_TCP_Window_Size  <= 32777){
                         if (m_TCP_Window_Size  <= 32726){
                            if (m_TCP_Window_Size  <= 32689){m_OS_Version = "Apple iOS 4.1"; }
                            if (m_TCP_Window_Size  > 32689){
                               if (m_TCP_Window_Size  <= 32705){
                                  if (m_TCP_Window_Size  <= 32691){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  if (m_TCP_Window_Size  > 32691){m_OS_Version = "Apple iOS 4.1"; }
                                  }
                               if (m_TCP_Window_Size  > 32705){
                                  if (m_TCP_Window_Size  <= 32720){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  if (m_TCP_Window_Size  > 32720){m_OS_Version = "Apple iOS 4.1"; }
                                  }
                               }
                            }
                         if (m_TCP_Window_Size  > 32726){m_OS_Version = "Apple iOS 4.1"; }
                         }
                      if (m_TCP_Window_Size  > 32777){
                         if (m_TCP_Window_Size  <= 32778){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                         if (m_TCP_Window_Size  > 32778){m_OS_Version = "Apple iOS 4.1"; }
                         }
                      }
                   }
                }
             if (m_TCP_Options.nop_set  > 3){
                if (m_TCP_Options.mss  <= 1452){m_OS_Version = "Apple iOS 4.1"; }
                if (m_TCP_Options.mss  > 1452){m_OS_Version = "Apple embedded noVersion"; }
                }
             }
          if (m_TCP_Window_Size  > 32832){m_OS_Version = "Apple iOS 4.1"; }
          }
       if (m_TCP_Window_Size  > 32876){
          if (m_TCP_Window_Size  <= 33305){
             if (m_TCP_Window_Size  <= 33214){
                if (m_TCP_Window_Size  <= 33195){
                   if (m_TCP_Window_Size  <= 33131){
                      if (m_TCP_Window_Size  <= 33085){
                         if (m_TCP_Window_Size  <= 32877){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                         if (m_TCP_Window_Size  > 32877){
                            if (m_TCP_Window_Size  <= 33072){
                               if (m_TCP_Window_Size  <= 33053){
                                  if (m_TCP_Window_Size  <= 33050){
                                     if (m_TCP_Window_Size  <= 32997){
                                        if (m_TCP_Window_Size  <= 32976){
                                           if (m_TCP_Window_Size  <= 32907){
                                              if (m_TCP_Window_Size  <= 32881){m_OS_Version = "Apple iOS 4.1"; }
                                              if (m_TCP_Window_Size  > 32881){
                                                 if (m_TCP_Window_Size  <= 32889){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                                 if (m_TCP_Window_Size  > 32889){
                                                    if (m_TCP_Window_Size  <= 32906){m_OS_Version = "Apple iOS 4.1"; }
                                                    if (m_TCP_Window_Size  > 32906){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                                    }
                                                 }
                                              }
                                           if (m_TCP_Window_Size  > 32907){m_OS_Version = "Apple iOS 4.1"; }
                                           }
                                        if (m_TCP_Window_Size  > 32976){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                        }
                                     if (m_TCP_Window_Size  > 32997){m_OS_Version = "Apple iOS 4.1"; }
                                     }
                                  if (m_TCP_Window_Size  > 33050){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  }
                               if (m_TCP_Window_Size  > 33053){m_OS_Version = "Apple iOS 4.1"; }
                               }
                            if (m_TCP_Window_Size  > 33072){
                               if (m_TCP_Window_Size  <= 33077){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                               if (m_TCP_Window_Size  > 33077){
                                  if (m_TCP_Window_Size  <= 33084){m_OS_Version = "Apple iOS 4.1"; }
                                  if (m_TCP_Window_Size  > 33084){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  }
                               }
                            }
                         }
                      if (m_TCP_Window_Size  > 33085){m_OS_Version = "Apple iOS 4.1"; }
                      }
                   if (m_TCP_Window_Size  > 33131){
                      if (m_TCP_Window_Size  <= 33133){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                      if (m_TCP_Window_Size  > 33133){
                         if (m_TCP_Window_Size  <= 33155){m_OS_Version = "Apple iOS 4.1"; }
                         if (m_TCP_Window_Size  > 33155){
                            if (m_TCP_Window_Size  <= 33157){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                            if (m_TCP_Window_Size  > 33157){
                               if (m_TCP_Window_Size  <= 33163){m_OS_Version = "Apple iOS 4.1"; }
                               if (m_TCP_Window_Size  > 33163){
                                  if (m_TCP_Window_Size  <= 33171){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  if (m_TCP_Window_Size  > 33171){
                                     if (m_TCP_Window_Size  <= 33194){m_OS_Version = "Apple iOS 4.1"; }
                                     if (m_TCP_Window_Size  > 33194){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                     }
                                  }
                               }
                            }
                         }
                      }
                   }
                if (m_TCP_Window_Size  > 33195){m_OS_Version = "Apple iOS 4.1"; }
                }
             if (m_TCP_Window_Size  > 33214){
                if (m_TCP_PSH  <= 0){
                   if (m_TCP_Window_Size  <= 33278){
                      if (m_TCP_Window_Size  <= 33262){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                      if (m_TCP_Window_Size  > 33262){
                         if (m_TCP_Window_Size  <= 33274){
                            if (m_TCP_Window_Size  <= 33273){
                               if (m_TCP_Window_Size  <= 33264){
                                  if (m_IP_TOS  <= 8){m_OS_Version = "Apple iOS 4.1"; }
                                  if (m_IP_TOS  > 8){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  }
                               if (m_TCP_Window_Size  > 33264){
                                  if (m_IP_TOS  <= 2){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                  if (m_IP_TOS  > 2){m_OS_Version = "Apple iOS 4.1"; }
                                  }
                               }
                            if (m_TCP_Window_Size  > 33273){m_OS_Version = "Apple iOS 4.1"; }
                            }
                         if (m_TCP_Window_Size  > 33274){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                         }
                      }
                   if (m_TCP_Window_Size  > 33278){
                      if (m_TCP_Options.mss  <= 1460){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                      if (m_TCP_Options.mss  > 1460){
                         if (m_TCP_Window_Size  <= 33303){
                            if (m_TCP_Window_Size  <= 33291){
                               if (m_TCP_Window_Size  <= 33282){
                                  if (m_TCP_Window_Size  <= 33281){
                                     if (m_IP_TOS  <= 8){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                     if (m_IP_TOS  > 8){m_OS_Version = "Apple iOS 4.1"; }
                                     }
                                  if (m_TCP_Window_Size  > 33281){m_OS_Version = "Apple iOS 4.1"; }
                                  }
                               if (m_TCP_Window_Size  > 33282){
                                  if (m_IP_TOS  <= 2){
                                     if (m_TCP_Window_Size  <= 33290){
                                        if (m_TCP_Window_Size  <= 33288){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                        if (m_TCP_Window_Size  > 33288){m_OS_Version = "Apple iOS 4.1"; }
                                        }
                                     if (m_TCP_Window_Size  > 33290){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                                     }
                                  if (m_IP_TOS  > 2){m_OS_Version = "Apple iOS 4.1"; }
                                  }
                               }
                            if (m_TCP_Window_Size  > 33291){m_OS_Version = "Apple iOS 4.1"; }
                            }
                         if (m_TCP_Window_Size  > 33303){
                            if (m_IP_TOS  <= 8){m_OS_Version = "Apple iOS 4.1"; }
                            if (m_IP_TOS  > 8){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                            }
                         }
                      }
                   }
                if (m_TCP_PSH  > 0){
                   if (m_TCP_Window_Size  <= 33281){m_OS_Version = "Apple iOS 4.1"; }
                   if (m_TCP_Window_Size  > 33281){
                      if (m_IP_TOS  <= 2){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                      if (m_IP_TOS  > 2){m_OS_Version = "Apple iOS 4.1"; }
                      }
                   }
                }
             }
          if (m_TCP_Window_Size  > 33305){
             if (m_TCP_Options.mss  <= 1335){m_OS_Version = "Apple Mac OS X 10.6.X"; }
             if (m_TCP_Options.mss  > 1335){
                if (m_IP_TOS  <= 16){
                   if (m_TCP_Options.nop_set  <= 0){
                      if (m_TCP_PSH  <= 0){
                         if (m_TCP_FIN  <= 0){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                         if (m_TCP_FIN  > 0){m_OS_Version = "Apple iOS 4.1"; }
                         }
                      if (m_TCP_PSH  > 0){m_OS_Version = "Apple iOS 4.1"; }
                      }
                   if (m_TCP_Options.nop_set  > 0){m_OS_Version = "Apple iOS 4.1"; }
                   }
                if (m_IP_TOS  > 16){m_OS_Version = "Apple Mac OS X 10.6.X"; }
                }
             }
          }
       }
    if (m_OS_Type == "unknown"){
       if (m_TCP_Window_Size  <= 23584){
          if (m_TCP_RST  <= 0){
             if (m_IP_TOS  <= 2){
                if (m_TCP_ACK == true && m_TCP_SYN == false){
                   if (m_TCP_Window_Size  <= 1461){m_OS_Version = "Axceint Uptiva backup appliance"; }
                   if (m_TCP_Window_Size  > 1461){
                      if (m_TCP_Window_Size  <= 1841){m_OS_Version = "HP Brocade 4Gb SAN switch"; }
                      if (m_TCP_Window_Size  > 1841){m_OS_Version = "Axceint Uptiva backup appliance"; }
                      }
                   }
                if (m_TCP_ACK == true && m_TCP_SYN == true){m_OS_Version = "HP Brocade 4Gb SAN switch"; }
                if (m_TCP_ACK == false && m_TCP_SYN == true){m_OS_Version = "Axceint Uptiva backup appliance"; }
                }
             if (m_IP_TOS  > 2){
                if (m_IP_TOS  <= 8){m_OS_Version = "Axceint Uptiva backup appliance"; }
                if (m_IP_TOS  > 8){m_OS_Version = "HP Brocade 4Gb SAN switch"; }
                }
             }
          if (m_TCP_RST  > 0){m_OS_Version = "Rockwell Automation embedded noVersion"; }
          }
       if (m_TCP_Window_Size  > 23584){m_OS_Version = "Rockwell Automation embedded noVersion"; }
       }

}

#endif
